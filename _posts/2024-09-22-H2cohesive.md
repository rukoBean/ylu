---
layout: post
title: 算H<sub>2</sub>结合能
---

---
{: data-content="TL;DR"}
H<sub>2</sub>结合能 = 
<a href='/H2cohesive_tests.html'>测试结果</a>
---

# 1. H原子
- INCAR

```
System = H atom

! init
ISTART = 0; ICHARG = 2 

! large cell
PREC=Accurate

! electronic self-consistency
ENCUT = 300
ISMEAR = 0; SIGMA = 0.1
EDIFF = 1E-05

! spin polarization
ISPIN = 2

```

不太明白`ISMEAR`是什么，看了一篇[官网的说明](https://www.vasp.at/wiki/index.php/Calculation_of_atoms)，里面提到：

> The only difference to the bulk calculation is that Gaussian smearing must be used now. You might set SIGMA to a very small value; this is necessary if atomic orbitals are almost degenerated. 

所以跟着设置了`ISMEAR = 0; SIGMA = 0.1`；`ENCUT`参照了POTCAR里的`ENMAX`值；有极性所以设置`ISPIN = 2`。

- POSCAR

```
H atom
10
1 0 0
0 1 0
0 0 1
H
1
cart
0 0 0

```

- KPOINTS

```
H atom
0
G
1  1  1
0  0  0
 
```

- POTCAR

```
PAW_PBE H 15Jun2001                    
   1.00000000000000     
…… …… …… ……
```

得到结果，其中

```
  …… …… …… ……

  atomic energy  EATOM  =        12.44577538
  Solvation  Ediel_sol  =         0.00000000
  ---------------------------------------------------
  free energy    TOTEN  =        -1.11159491 eV

  energy without entropy =       -1.11159491  energy(sigma->0) =       -1.11159491

  …… …… …… ……

```

# 2. H<sub>2</sub>分子
- INCAR

```
System = H2 molecule

! init
ISTART = 0; ICHARG = 2 

! large cell
PREC=Accurate

! electronic self-consistency
ENCUT = 300
ISMEAR = 0; SIGMA = 0.1
EDIFF = 1E-05

! ionic relaxation
IBRION = 2
NSW = 50
ISIF = 2
EDIFFG = -0.02

```
看了[官网这页](https://www.vasp.at/wiki/index.php/ISIF)的表格:

<table cellpadding="5" cellspacing="0" border="1"><tbody><tr><td><a class="mw-selflink selflink">ISIF</a></td><td colspan="2" style="text-align: center;">calculate</td><td colspan="3" style="text-align: center;">degrees-of-freedom</td></tr><tr><td></td><td>forces</td><td>stress tensor</td><td>positions</td><td>cell shape</td><td>cell volume</td></tr><tr><td>0</td><td>yes</td><td>no</td><td>yes</td><td>no</td><td>no</td></tr><tr><td>1</td><td>yes</td><td>trace only</td><td>yes</td><td>no</td><td>no</td></tr><tr><td>2</td><td>yes</td><td>yes</td><td>yes</td><td>no</td><td>no</td></tr><tr><td>3</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>4</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>no</td></tr><tr><td>5</td><td>yes</td><td>yes</td><td>no</td><td>yes</td><td>no</td></tr><tr><td>6</td><td>yes</td><td>yes</td><td>no</td><td>yes</td><td>yes</td></tr><tr><td>7</td><td>yes</td><td>yes</td><td>no</td><td>no</td><td>yes</td></tr><tr><td>8</td><td>yes</td><td>yes</td><td>yes</td><td>no</td><td>yes</td></tr></tbody></table>

设置了`ISIF = 2`。

- POSCAR

```
H2 in a box
10
1 0 0
0 1 0
0 0 1
H
2
cart
0 0 0
0 0 0.74

```

- KPOINTS

```
H2
0
G
1  1  1
0  0  0
 
```

- POTCAR

```
PAW_PBE H 15Jun2001                    
   1.00000000000000    

…… …… …… ……

```

得到的结果是

```
free energy    TOTEN  =        -6.72318416 eV

energy without entropy =       -6.72318416  energy(sigma->0) =       -6.72318416
```

H<sub>2</sub>结合能为
-6.72318416 eV - 2*（-1.11159491 eV）= -4.49999434 eV

有关文献[^1]给出的参考值是-4.48eV

# 3. 测试
测试了H原子的`ENCUT`和POSCAR里的比例系数；想着应该把H原子和H<sub>2</sub>分子放在同一个大小的盒子里比较，对H<sub>2</sub>分子只测试了`ENCUT`。
尝试写了脚本：

- 测试H原子`ENCUT`

```
#!/bin/bash
n=1
for i in $(seq 250 25 600) 650 700 750;
do
    cp -r H_atom/ H_1_$n/
    sed -i "/ENCUT/c\ENCUT = $i" H_1_$n/INCAR
    cd H_1_$n/
    qsub wz.pbs
    cd ..
    n=$((n+1))
done
```

- 测试H原子POSCAR

```
n=1
for i in $(seq 8 1 19);
do
cp -r H_atom/ H_2_$n/
cd H_2_$n/
cat > POSCAR <<HERE
H atom
$i
1 0 0
0 1 0
0 0 1
H
1
cart
0 0 0

HERE
qsub wz.pbs
cd ..
n=$((n+1))
done
```
- 测试H<sub>2</sub>分子`ENCUT`

```
#!/bin/bash
n=1
for i in $(seq 250 25 600) 650 700 750;
do
    cp -r H2_molecule/ H2_molecule_$n/
    sed -i "/ENCUT/c\ENCUT = $i" H2_molecule_$n/INCAR
    cd H2_molecule_$n/
    qsub wz.pbs
    cd ..
    n=$((n+1))
done
```
测试结果在<a href='/H2cohesive_tests.html'>这里</a>。
取

---
{: data-content="footnotes"}

[^1]: G. Kresse and J. Hafner, Surface Science 459, 287 (2000).